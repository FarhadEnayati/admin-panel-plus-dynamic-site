(function(){function b(a,b,d){if(b=h[this.id])for(var f=this instanceof CKEDITOR.ui.dialog.checkbox,p=0;p<b.length;p++){var e=b[p];switch(e.type){case 1:if(!a)continue;null!==a.getAttribute(e.name)&&(e=a.getAttribute(e.name),this.setValue(e));break;case 2:if(!a)continue;if(e.name in d){e=d[e.name];f?this.setValue("1"==e.toLowerCase()):this.setValue(e);return}f&&this.setValue(!!e["default"])}}}function d(a,b,d){if(b=h[this.id])for(var f=""===this.getValue(),p=this instanceof CKEDITOR.ui.dialog.checkbox,
e=0;e<b.length;e++){var c=b[e];switch(c.type){case 1:if(!a)continue;var l=this.getValue();f&&!c["default"]?a.removeAttribute(c.name):!l&&c["default"]?a.setAttribute(c.name,c["default"]):a.setAttribute(c.name,l);break;case 2:if(!a)continue;l=this.getValue();!l&&c["default"]&&(l=c["default"]);!0===l&&p&&(l="1");if(f&&!c["default"])c.name in d&&d[c.name].remove();else{if("FlashVars"==c.name){var g="0",k="0",q="";for(ii=0;ii<a.getChildCount();ii++){item=a.getChildren().getItem(ii).$;n=item.getAttribute("name");
v=item.getAttribute("value");switch(n){case "play":g=v;break;case "loop":k=v;break;case "src":q=v}l="flv=$FILE$&config=/flash/config.txt?t=1&loop=$LOOP$&autoplay=$PLAY$".replace("$PLAY$",g).replace("$LOOP$",k).replace("$FILE$",q)}}c.name in d?d[c.name].setAttribute("value",l):(g=CKEDITOR.dom.element.createFromHtml("<cke:param></cke:param>",a.getDocument()),g.setAttributes({name:c.name,value:l}),l&&(1>a.getChildCount()?g.appendTo(a):g.insertBefore(a.getFirst())))}}}}for(var h={id:[{type:1,name:"id"}],
src:[{type:2,name:"src"}],align:[{type:1,name:"align"}],width:[{type:1,name:"width","default":"700"}],height:[{type:1,name:"height","default":"400"}],hSpace:[{type:1,name:"hSpace"}],vSpace:[{type:1,name:"vSpace"}],style:[{type:1,name:"style"}],type:[{type:1,name:"type","default":"application/x-shockwave-flash"}],data:[{type:1,name:"data","default":"/flash/player_flv_multi.swf"}]},r=["movie","play","loop","FlashVars","allowFullScreen"],m=0;m<r.length;m++)h[r[m]]=[{type:2,name:r[m]}];h.movie[0]["default"]=
"/flash/player_flv_multi.swf";h.FlashVars[0]["default"]="-";h.allowFullScreen[0]["default"]="true";CKEDITOR.dialog.add("flash",function(a){var h,m="<div>"+CKEDITOR.tools.htmlEncode(a.lang.common.preview)+'<br/><br/><div id="cke_FlashPreviewBox'+CKEDITOR.tools.getNextNumber()+'" class="FlashPreviewBox"></div></div>';return{title:a.lang.flash.title,minWidth:420,minHeight:310,onShow:function(){this.fakeImage=this.objectNode=this.embedNode=null;h=new CKEDITOR.dom.element("embed",a.document);var f=this.getSelectedElement();
if(f&&f.data("cke-real-element-type")&&"flash"==f.data("cke-real-element-type")){this.fakeImage=f;var b=a.restoreRealElement(f),e=null,c={};if("cke:object"==b.getName())for(var e=b,b=e.getElementsByTag("param","cke"),d=0,g=b.count();d<g;d++){var k=b.getItem(d),q=k.getAttribute("name"),k=k.getAttribute("value");c[q]=k}this.objectNode=e;this.setupContent(e,null,c,f)}},onOk:function(){for(var f=null,b=null,f=this.fakeImage?this.objectNode:CKEDITOR.dom.element.createFromHtml("<cke:object></cke:object>",
a.document),b={},e=f.getElementsByTag("param","cke"),c=0,d=e.count();c<d;c++){var g=e.getItem(c),k=g.getAttribute("name");g.getAttribute("value");b[k]=e.getItem(c)}var k={},h={};this.commitContent(f,null,b,k,h);e=f.getElementsByTag("param","cke");b="";c=0;for(d=e.count();c<d;c++)if(g=e.getItem(c),"src"==g.getAttribute("name")){b=g.getAttribute("value");break}f=a.createFakeElement(f,"cke_flash","flash",!0);f.setAttributes(h);f.setStyles(k);this.fakeImage?(f.replace(this.fakeImage),a.getSelection().selectElement(f)):
a.insertElement(f);b&&(f=CKEDITOR.dom.element.createFromHtml("<p></p>"),e=CKEDITOR.dom.element.createFromHtml('<a class="post-video-link" href="'+b+'" target="_blank"><img alt="\u062f\u0631\u06cc\u0627\u0641\u062a \u0648\u06cc\u062f\u0626\u0648" ></a>'),a.insertElement(f),a.insertElement(e),a.insertElement(f))},onHide:function(){this.objectNode=null;this.preview&&this.preview.setHtml("")},contents:[{id:"info",label:a.lang.common.generalTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",
widths:["280px","110px"],align:"right",children:[{id:"src",type:"text",style:"width:410px",label:a.lang.common.url,required:!0,validate:CKEDITOR.dialog.validate.notEmpty(a.lang.flash.validateSrc),setup:b,commit:d,onLoad:function(){var a=this.getDialog(),b=function(b){h.setAttribute("src",b);var c;c='<object type="application/x-shockwave-flash" data="/flash/player_flv_multi.swf" width="100%" height="100%"><param name="allowFullScreen" value="true" /><param name="movie" value="/flash/player_flv_multi.swf" />';
c+='<param name="FlashVars" value="flv='+CKEDITOR.tools.htmlEncode(b)+'&config=/flash/config.txt?t=1" /></object>';a.preview.setHtml(c)};a.preview=a.getContentElement("info","preview").getElement().getChild(3);this.on("change",function(a){a.data&&a.data.value&&b(a.data.value)});this.getInputElement().on("change",function(a){b(this.getValue())},this)}},{type:"button",id:"browse",filebrowser:"info:src",hidden:!0,style:"display:inline-block;margin-top:14px;",label:a.lang.common.browseServer}]}]},{type:"hbox",
widths:["25%","25%","25%","25%","25%"],children:[{type:"text",id:"width",requiredContent:"embed[width]",style:"width:95px",label:a.lang.common.width,validate:CKEDITOR.dialog.validate.htmlLength(a.lang.common.invalidHtmlLength.replace("%1",a.lang.common.width)),setup:b,commit:d},{type:"text",id:"height",requiredContent:"embed[height]",style:"width:95px",label:a.lang.common.height,validate:CKEDITOR.dialog.validate.htmlLength(a.lang.common.invalidHtmlLength.replace("%1",a.lang.common.height)),setup:b,
commit:d},{type:"text",id:"hSpace",requiredContent:"embed[hspace]",style:"width:95px",label:a.lang.flash.hSpace,validate:CKEDITOR.dialog.validate.integer(a.lang.flash.validateHSpace),setup:b,commit:d},{type:"text",id:"vSpace",requiredContent:"embed[vspace]",style:"width:95px",label:a.lang.flash.vSpace,validate:CKEDITOR.dialog.validate.integer(a.lang.flash.validateVSpace),setup:b,commit:d},{type:"text",id:"type",style:"display:none",setup:b,commit:d},{type:"text",id:"data",style:"display:none",setup:b,
commit:d}]},{type:"vbox",children:[{type:"html",id:"preview",style:"width:95%;",html:m}]}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:a.lang.common.upload,elements:[{type:"file",id:"upload",label:a.lang.common.upload,size:38},{type:"fileButton",id:"uploadButton",label:a.lang.common.uploadSubmit,filebrowser:"info:src","for":["Upload","upload"]}]},{id:"properties",label:a.lang.flash.propertiesTab,elements:[{type:"fieldset",label:CKEDITOR.tools.htmlEncode(a.lang.flash.flashvars),children:[{type:"vbox",
padding:0,children:[{type:"checkbox",id:"play",label:a.lang.flash.chkPlay,setup:b,commit:d},{type:"checkbox",id:"loop",label:a.lang.flash.chkLoop,setup:b,commit:d},{type:"text",id:"movie",style:"display:none",setup:b,commit:d},{type:"text",id:"allowFullScreen",style:"display:none",setup:b,commit:d},{type:"text",id:"FlashVars",style:"display:none",setup:b,commit:d}]}]}]},{id:"advanced",label:a.lang.common.advancedTab,elements:[{type:"hbox",children:[{type:"text",id:"id",requiredContent:"object[id]",
label:a.lang.common.id,setup:b,commit:d}]},{type:"text",id:"class",requiredContent:"embed(cke-xyz)",label:a.lang.common.cssClass,setup:b,commit:d},{type:"text",id:"style",requiredContent:"embed{cke-xyz}",validate:CKEDITOR.dialog.validate.inlineStyle(a.lang.common.invalidInlineStyle),label:a.lang.common.cssStyle,setup:b,commit:d}]}]}})})();